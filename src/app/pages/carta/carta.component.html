<!-- CARTA CON DISEÑO RELAJADO -->
<div class="carta-container">
  <!-- Header simple -->

  <!-- Botón carrito simple -->
  <div *ngIf="estaLogueado() && mostrarCarrito && !carritoAbierto">
    <button
      class="btn-carrito-simple"
      aria-label="mostrar carrito de compras"
      (click)="toggleCarrito()"
    >
      <i class="fa fa-shopping-cart" aria-hidden="true"></i>
      <span class="carrito-count" *ngIf="cantidadTotalCarrito > 0">{{cantidadTotalCarrito}}</span>
    </button>
  </div>

  <!-- Filtros simples -->
  <div class="filtros-container">
    <button 
      class="filtro-btn" 
      [class.active]="filtroCategoria==='todas'" 
      (click)="filtroCategoria='todas'"
    >
      Todas
    </button>
    <button 
      class="filtro-btn" 
      [class.active]="filtroCategoria==='hamburguesas'" 
      (click)="filtroCategoria='hamburguesas'"
    >
      Hamburguesas
    </button>
    <button 
      class="filtro-btn" 
      [class.active]="filtroCategoria==='lomos'" 
      (click)="filtroCategoria='lomos'"
    >
      Lomos
    </button>
    <button 
      class="filtro-btn" 
      [class.active]="filtroCategoria==='empanadas'" 
      (click)="filtroCategoria='empanadas'"
    >
      Empanadas
    </button>
  </div>
  <!-- Grid de productos simple -->
  <div class="productos-grid">
    <div *ngFor="let product of productosFiltrados | paginate : { itemsPerPage: 6, currentPage: p }; trackBy: trackByProductId" class="producto-card">
      <div class="producto-imagen-container">
        <img 
          [src]="product.imageURL || 'assets/carta/hamburguesa.webp'" 
          [alt]="product.nombre_producto" 
          class="producto-imagen"
          [ngClass]="{'empanada-pollo': product.nombre_producto === 'Empanadas de Pollo'}"
          (click)="cargarModal(product)"
          (error)="onImageError($event)"
        />
        <div class="precio-tag">${{product.precio | number:'1.0-0'}}</div>
        <div *ngIf="product.stock > 0; else noStock" class="stock-disponible">Disponible</div>
        <ng-template #noStock>
          <div class="stock-agotado">Sin Stock</div>
        </ng-template>
      </div>
      
      <div class="producto-info">
        <h3 class="producto-nombre">{{product.nombre_producto}}</h3>
        <p class="producto-descripcion">{{product.descripcion}}</p>
        
        <button 
          *ngIf="product.stock > 0; else noStockBtn"
          class="btn-agregar"
          (click)="cargarModal(product)"
        >
          Agregar al carrito
        </button>
        <ng-template #noStockBtn>
          <button 
            class="btn-agregar disabled"
            disabled
          >
            Sin stock
          </button>
        </ng-template>
      </div>
    </div>
  </div>

  <!-- Paginación simple -->
  <div class="paginacion-container" *ngIf="productosFiltrados.length > 6">
    <pagination-controls
      (pageChange)="p = $event"
      [autoHide]="true"
      [responsive]="true"
      class="paginacion-simple"
    ></pagination-controls>
  </div>

  <!-- Modal de compra simple -->
  <div
    class="modal fade"
    id="modalCompra"
    data-bs-backdrop="static"
    data-bs-keyboard="false"
    tabindex="-1"
    aria-labelledby="staticBackdropLabel"
    aria-hidden="true"
  >
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">{{producto.nombre_producto}}</h5>
          <button
            type="button"
            class="btn-close"
            data-bs-dismiss="modal"
            aria-label="Close"
          ></button>
        </div>
        <div class="modal-body">
          <div class="modal-imagen-container">
            <img
              class="modal-imagen"
              [src]="producto.imageURL || 'assets/carta/hamburguesa.webp'"
              [alt]="producto.nombre_producto"
              (error)="onImageError($event)"
            />
          </div>
          
          <div class="modal-precio">
            Precio: ${{producto.precio | number:'1.0-0'}}
          </div>

          <div class="cantidad-container">
            <label class="cantidad-label">Cantidad:</label>
            <div class="cantidad-controles">
              <button 
                type="button" 
                class="btn-cantidad"
                (click)="decrementarCantidadModal()"
              >
                -
              </button>
              <input
                type="number"
                class="cantidad-input"
                [(ngModel)]="cantidadIngresada"
                (input)="calcularSubtotal()"
                min="1"
                readonly
              />
              <button 
                type="button" 
                class="btn-cantidad"
                (click)="incrementarCantidadModal()"
              >
                +
              </button>
            </div>
          </div>

          <div class="subtotal-container">
            <strong>Subtotal: ${{subtotal | number:'1.0-0'}}</strong>
          </div>
        </div>
        
        <div class="modal-footer">
          <button 
            type="button" 
            class="btn btn-secondary" 
            data-bs-dismiss="modal"
          >
            Cancelar
          </button>
          <button
            type="button"
            class="btn btn-primary"
            (click)="addProducto()"
          >
            Añadir al carrito
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal de imagen simple -->
  <div
    class="modal fade"
    id="modalImagen"
    tabindex="-1"
    aria-labelledby="modalImagen"
    aria-hidden="true"
  >
    <div class="modal-dialog modal-lg modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <button
            type="button"
            class="btn-close"
            data-bs-dismiss="modal"
            aria-label="Close"
          ></button>
        </div>
        <div class="modal-body text-center">
          <img
            class="img-fluid"
            [src]="producto.imageURL"
            [alt]="producto.nombre_producto"
          />
        </div>
      </div>
    </div>
  </div>
</div>